# Задача 18.1: Команда бота для постинга закрепляемой ссылки TMA

## Связь с юзер-кейсами
- UC-05: Bot commands and notifications

## Цель задачи
Добавить админскую команду бота, которая публикует в публичный канал сообщение с кнопкой открытия WebApp, чтобы можно было закрепить сообщение в канале.

## Описание изменений

### Изменения в существующих файлах
- `apps/server/src/bot/commands.ts` — добавить `/post_tma` (admin-only) и отправку сообщения в канал.
- `apps/server/src/bot/channel.ts` — добавить helper для сообщения с WebApp кнопкой.
- `apps/server/src/routes/telegramWebhook.ts` — передать username в handler для проверки админа.
- `docs/runbooks/ops.md` — описать команду и проверку результата.

## Детали по реализации
- Ограничить `/post_tma` пользователями из `ADMIN_TELEGRAM_IDS` (id/username).
- Использовать `WEB_APP_URL` для `web_app` кнопки и `PUBLIC_CHANNEL_ID` для канала.
- Ответить пользователю в личке об успехе/ошибке.

## Тест-кейсы

### End-to-end тесты
1. **TC-E2E-18.1-01:** Админ отправляет `/post_tma` и получает подтверждение.
2. **TC-E2E-18.1-02:** В канале появляется сообщение с кнопкой Open WebApp.

### Регрессионные тесты
- `npx playwright test --headed` (если выполняется общий прогон).

## Критерии приёмки
- [ ] `/post_tma` доступен только админам.
- [ ] В канале появляется сообщение с кнопкой Open WebApp, готовое для закрепления.
- [ ] Ошибки конфигурации (`WEB_APP_URL`) возвращают понятное сообщение.

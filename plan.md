# План разработки: Project Noetic Mirror

## Последовательность выполнения задач

### Этап 1: Создание структуры и заглушек
- **Задача 1.1** — Скелет монорепо (web/server/worker/shared), базовая конфигурация и UI-макет
  - Юзер-кейсы: UC-01, UC-02
  - Файл описания: `tasks/task_1_1.md`
  - Приоритет: Критичный
  - Зависимости: нет

- **Задача 1.2** — Слой данных и заглушки хранилищ (Postgres/Redis)
  - Юзер-кейсы: UC-02, UC-03, UC-07
  - Файл описания: `tasks/task_1_2.md`
  - Приоритет: Высокий
  - Зависимости: Задача 1.1

- **Задача 1.3** — Базовый E2E (local) с заглушками и визуальной проверкой
  - Юзер-кейсы: UC-01, UC-02
  - Файл описания: `tasks/task_1_3.md`
  - Приоритет: Высокий
  - Зависимости: Задача 1.1

### Этап 2: Реализация основного функционала
- **Задача 2.1** — Auth/consent + валидация initData
  - Юзер-кейсы: UC-01
  - Файл описания: `tasks/task_2_1.md`
  - Приоритет: Критичный
  - Зависимости: Задача 1.1

- **Задача 2.2** — WebSocket стриминг, sequence IDs, reconnect
  - Юзер-кейсы: UC-02, UC-07
  - Файл описания: `tasks/task_2_2.md`
  - Приоритет: Критичный
  - Зависимости: Задача 1.2

- **Задача 3.1** — OpenAI Researcher (Responses API), бюджеты, guardrails
  - Юзер-кейсы: UC-02, UC-06
  - Файл описания: `tasks/task_3_1.md`
  - Приоритет: Высокий
  - Зависимости: Задача 2.2

- **Задача 3.2** — Gemini Subject (3.x), контекст, кеширование
  - Юзер-кейсы: UC-02, UC-06
  - Файл описания: `tasks/task_3_2.md`
  - Приоритет: Высокий
  - Зависимости: Задача 3.1

- **Задача 3.3** — Интервенции, телеметрия, safety thresholds
  - Юзер-кейсы: UC-04, UC-06
  - Файл описания: `tasks/task_3_3.md`
  - Приоритет: Высокий
  - Зависимости: Задача 3.2

### Этап 3: Платежи и бот
- **Задача 4.1** — Telegram Stars платежи, entitlements, receipts
  - Юзер-кейсы: UC-03, UC-04
  - Файл описания: `tasks/task_4_1.md`
  - Приоритет: Критичный
  - Зависимости: Задача 2.1

- **Задача 4.2** — Команды бота и постинг в канал
  - Юзер-кейсы: UC-05
  - Файл описания: `tasks/task_4_2.md`
  - Приоритет: Средний
  - Зависимости: Задача 4.1

### Этап 4: Персистентность и ops
- **Задача 5.1** — Реальная персистентность (Postgres/Redis) + retention job
  - Юзер-кейсы: UC-02, UC-07
  - Файл описания: `tasks/task_5_1.md`
  - Приоритет: Высокий
  - Зависимости: Задача 1.2

- **Задача 6.1** — Observability (структурные логи, трассировка, ops)
  - Юзер-кейсы: UC-06
  - Файл описания: `tasks/task_6_1.md`
  - Приоритет: Средний
  - Зависимости: Задача 5.1

### Этап 5: CI/CD и деплой
- **Задача 7.1** — Docker/Cloud Build, deploy script, runbooks
  - Юзер-кейсы: UC-02
  - Файл описания: `tasks/task_7_1.md`
  - Приоритет: Высокий
  - Зависимости: Задача 5.1

- **Задача 7.2** — GitHub Actions (lint/test/e2e/deploy)
  - Юзер-кейсы: UC-02
  - Файл описания: `tasks/task_7_2.md`
  - Приоритет: Средний
  - Зависимости: Задача 7.1

### Этап 6: QA и релиз
- **Задача 8.1** — Playwright E2E (local + prod) и release loop
  - Юзер-кейсы: UC-01, UC-02, UC-03, UC-04, UC-05, UC-07
  - Файл описания: `tasks/task_8_1.md`
  - Приоритет: Критичный
  - Зависимости: Задача 7.1

### Этап 7: Breath telemetry
- **Задача 9.1** — Breath telemetry pipeline (schema + compute + storage)
  - Юзер-кейсы: UC-08
  - Файл описания: `tasks/task_9_1.md`
  - Приоритет: Высокий
  - Зависимости: Задача 3.3, Задача 5.1

- **Задача 9.2** — Breath UI widget + diagnostics + E2E coverage
  - Юзер-кейсы: UC-08
  - Файл описания: `tasks/task_9_2.md`
  - Приоритет: Средний
  - Зависимости: Задача 9.1

### Этап 8: Admin UI enhancements
- **Задача 10.1** — Display model versions in Admin UI
  - Юзер-кейсы: UC-06
  - Файл описания: `tasks/task_10_1.md`
  - Приоритет: Средний
  - Зависимости: Задача 2.1

## Покрытие юзер-кейсов

| Юзер-кейс | Задачи |
|-----------|--------|
| UC-01 | 1.1, 1.3, 2.1, 8.1 |
| UC-02 | 1.1, 1.2, 1.3, 2.2, 3.1, 3.2, 5.1, 7.1, 8.1 |
| UC-03 | 1.2, 4.1, 8.1 |
| UC-04 | 3.3, 4.1, 8.1 |
| UC-05 | 4.2, 8.1 |
| UC-06 | 3.1, 3.2, 3.3, 6.1, 10.1 |
| UC-07 | 1.2, 2.2, 5.1, 8.1 |
| UC-08 | 9.1, 9.2 |
